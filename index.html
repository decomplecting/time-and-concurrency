<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <title>Time and Concurrency</title>
        <meta name="description" content="OOP themes can't melt FP dreams">
        <meta name="author" content="Jason Lewis">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/league.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text.css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
        <style type="text/css">
         img.inline-logo {
             margin: 1px;
             text-align: center;
             display: inline-block;
             border: 0px !important;
             float: left;
             background: rgba(255, 255, 255, 0) !important;
             box-shadow: 0 0 0px rgba(0, 0, 0, 0); important!;
             align: center;
         }
         .img-wrap {
             border: 0px !important;
             display: inline-block;
             margin: auto;
             text-align: center;
         }
         img.scaled {
             max-height: 512px;
             margin: auto;
         }
         p.large {
             font-size: 72pt;
         }
        </style>

    </head>

    <body>

        <div class="reveal">

            <div class="slides">
                <section>
                    <h1>Time and Concurrency</h1>
                    <h3>Programming paradigms and the failure of state</h3>
                    <p>Jason Lewis</p>
                    <p>
                        <a href="https://twitter.com/canweriotnow">
                            @canweriotnow
                        </a>
                    </p>
                    <p>Yet Analytics</p>
                </section>
                <section>
                    <h2>Hello</h2>
                    <section>
                        <p>I think I was destined to become a functional programmer.</p>
                    </section>
                    <section>
                        <p>Some years ago</p>
                        <img src="res/punk1.jpg">
                    </section>
                    <section>
                        <p>I <s>spraypainted</s> liked graffiti like this...</p>
                        <img src="res/smash-state.jpg">
                    </section>
                    <section>
                        <p>...and ended up here.</p>
                        <img src="res/state-rich-hickey.jpg">
                    </section>
                </section>
                <section>
                    <h2>Time</h2>

                    <section>
                        <h3>We have problems with:</h3>
                        <ul>
                            <li>State</li>
                            <li>Value</li>
                            <li>Identity</li>
                        </ul>
                    </section>
                    <section>
                        <blockquote cite="https://en.wikiquote.org/wiki/Heraclitus">
                            <p>You could not step twice into the same river.</p>
                            <footer>
                                &mdash;
                                <a href="https://en.wikiquote.org/wiki/Heraclitus">
                                    Heraclitus of Ephesus
                                </a>
                            </footer>
                        </blockquote>
                        <img src="res/euphrates05.jpg" width="640px">
                    </section>
                    <section>
                        <h3>Problems are both:</h3>
                        <ul>
                            <li>In our programs</li>
                            <li>In our datastores</li>
                        </ul>
                    </section>
                    <section>

                        <h4>There are solutions</h4>
                        <div>
                            <div class="img-wrap">
                                <img src="res/clojure-250.png" class="inline-logo" width="250px">
                                <p>Clojure</p>
                            </div>
                            <div class ="img-wrap">
                                <img src="res/datomic.png" class="inline-logo" width="250px">
                                <p>Datomic</p>
                            </div>
                        </div>
                        <p>(of which these are but two)</p>
                    </section>
                    <section>
                        <h2>What is it?</h2>
                    </section>
                </section>
                <section>
                    <h3>An Expert Explains</h3>
                    <video width="720" controls="true">
                        <source src="res/timey-wimey.mp4" type="video/mp4">
                    </video>
                </section>
                <section>
                    <h3>Time</h3>
                    <section>
                        <h6>Perception</h6>
                        <img src="res/atob.png">
                    </section>
                    <section>
                        <h6>Reality</h6>
                        <img src="res/kitten-yarn.jpg">
                    </section>
                </section>

                <!-- Concurrency -->
                <section>
                    <h2>Concurrency</h2>
                    <p>Really, <code>(>= things 3)</code> </p>
                    <ul>
                        <li>Concurrency</li>
                        <li>Parallellism</li>
                        <li>Distributed systems</li>
                        <li>...</li>
                    </ul>
                </section>
                <section>
                    <h3>Concurrency</h3>
                    <section>
                        <p>Object-Oriented (stateful):</p>
                        <ul>
                            <li>Stateful objects</li>
                            <li>Mutexes and locking</li>
                            <li>No (realistic) notion of time</li>
                        </ul>
                    </section>
                    <section>
                        <img src="res/futbol-blast.gif">
                    </section>
                    <section>
                        <p>Functional:</p>
                        <ul>
                            <li>Pure fns are timeless</li>
                            <li>Zero state</li>
                            <li>Run anywhen, anywhere, same result</li>
                        </ul>
                    </section>
                    <section>
                        <img src="res/cat.hammock.gif">
                    </section>
                </section>
                <section>
                    <h2>Clojure(Script)</h2>
                    <section>
                        <ul>
                            <li>Emphasis on pure functions</li>
                            <li>Persistent data structures</li>
                            <li>Side-effects are allowed</li>
                            <li>State is <em>managed</em></li>
                        </ul>
                    </section>
                    <section>
                        <p>
                            Web programming <strong>IS</strong> distributed
                            systems programming.
                        </p>
                    </section>
                    <section>
                        <p>
                            Even in the simplest web application, we need to
                            consider at least 3 things: the server, the browser,
                            and the user.
                        </p>
                        <img src="res/ubs.png">
                    </section>
                    <section>
                        <p>One language, two hosts:</p>
                        <ul>
                            <li>JVM (server)</li>
                            <li>JS (browser)</li>
                        </ul>
                    </section>
                    <section>
                        <p>Code Sharing</p>
                        <pre>
                            <code>
(defn str->int [s]
  #?(:clj  (java.lang.Integer/parseInt s)
     :cljs (js/parseInt s)))
                            </code>
                        </pre>
                    </section>
                </section>
                <section>
                    <h2>Datomic</h2>
                    <section>
                        <ul>
                            <li>
                                EAVT tuple store database.
                            </li>
                            <li>
                                ACID transactions.
                            </li>
                            <li>
                                Immutable data = strong consistency +
                                horizontal read scalability.
                            </li>
                            <li>
                                Writes are not update-in-place; all data is
                                retained by default.
                            </li>
                            <li>
                                Makes <em>time</em> part of the database itself.
                            </li>
                        </ul>
                    </section>
                    <section>
                        <h5>Big win:</h5>
                        <h2>TIME TRAVEL</h2>
                    </section>
                    <section>
                        <p>
                            Since Datomic retains the history of the db state,
                            we can query the db as-of any given point in time.
                        </p>
                        <p>
                            Since it treats the db as a <em>value,</em> and uses
                            the same persistent data structures as
                            Clojure itself, we can also <em>query the future,</em>
                            by joining arbitrary data to a given db value.
                        </p>

                    </section>
                    <section>
                        <h5>It gets better...</h5>
                        <pre><code>
(q '[:find ?title
     :where
     [?e :movie/year 1987]
     [?e :movie/title ?title]])
                        </code></pre>
                        <p>
                            Datomic's datalog queries are just
                            <em>vectors,</em> which means they can be
                            passed around like any other of Clojure's
                            persistent data structures... even from the
                            browser to the server.
                        </p>
                    </section>
                </section>
                <section>
                    <h3>Putting it all together</h3>
                    <section>
                        <img src="res/chart.png" class="scaled">
                    </section>
                    <section>
                        <ul>
                            <li>
                                Pure functions acting on immutable data
                                structures shared between client and
                                server.
                            </li>
                            <li>
                                Peers keep a hot copy of the db as a value in memory
                            </li>
                            <li>
                                Reads and writes are orthogonal
                            </li>
                    </section>
                    <section>
                        <p class="large"">Time = λ</p>
                    </section>
                </section>
                <!--end stuff-->
                <section>
                    <p>Baltimore Clojure Meetup</p>
                    <img src="res/bmore-clojure.jpg">
                    <p>
                        <a href="http://is.gd/baltimoreclojure">
                            http://is.gd/baltimoreclojure
                        </a>
                    </p>
                </section>
                <section>
                    <h2>Thank You!</h2>
                    <p>Jason Lewis</p>
                    <p>Yet Analytics</p>
                    <p><a href="https://twitter.com/canweriotnow">
                        @canweriotnow
                    </a></p>
                    <p>jason@yetanalytics.com</p>
                    <img src="res/yet-logo.png">
                </section>
            </div>
        </div>
        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                transition: 'slide', //none/fade/slide/convex/concave/zoom

                //Plugins
                dependencies: [
                    { src: 'lib/js/classList.js',
                      condition: function() { return !document.body.classList; }
                    },
                    { src: 'plugin/markdown/marked.js',
                      condition: function() {
                          return !!document.querySelector( '[data-markdown]');
                      }
                    },
                    { src: 'plugin/markdown/markdown.js',
                      condition: function() {
                          return !!document.querySelector( '[data-markdown]');
                      }
                    },
                    { src: 'plugin/highlight/highlight.js',
                      async: true,
                      condition: function() {
                          return !!document.querySelector( 'pre code');
                      }
                    },
                    {src: 'plugin/zoom-js/zoom.js', async: true },
                    {src: 'plugin/notes/notes.js', async: true}
                ]
            })
        </script>
    </body>
</html>
